./tasks/todo.md:- [ ] Fix "Nombre del Bloque" Label
Binary file ./.next/cache/webpack/client-production/9.pack matches
Binary file ./.next/cache/webpack/client-production/14.pack matches
Binary file ./.next/cache/webpack/client-production/13.pack matches
Binary file ./.next/cache/webpack/client-production/11.pack matches
Binary file ./.next/cache/webpack/client-production/10.pack matches
Binary file ./.next/cache/webpack/client-production/6.pack matches
Binary file ./.next/cache/webpack/server-production/9.pack matches
Binary file ./.next/cache/webpack/server-production/4.pack matches
Binary file ./.next/cache/webpack/server-production/8.pack matches
Binary file ./.next/cache/webpack/server-production/11.pack matches
Binary file ./.next/cache/webpack/server-production/7.pack matches
./.next/server/chunks/5534.js:                        ${T?"bg-cv-accent text-white hover:bg-cv-accent/90":"bg-slate-200 dark:bg-slate-700 text-slate-400 dark:text-slate-500 cursor-not-allowed"}`,children:[a.jsx(c.Z,{size:16}),a.jsx("span",{className:"hidden sm:inline",children:"OK"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Nombre del Bloque / Ejercicio Principal"}),a.jsx(I,{value:j.name||"",onChange:t=>n(e,{name:t||null}),placeholder:"Buscar ejercicio...",className:"cv-input",inputRef:f})]}),("metcon_structured"===j.type||"warmup"===j.type||"accessory"===j.type)&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Metodolog\xeda de Entrenamiento"}),u?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-cv-accent"})}):(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 no-scrollbar",children:z.map(e=>{let t=Z[e]||[];if(0===t.length)return null;let s=g===e,r=t.some(e=>e.code===j?.format),l=_[e]||C.Z;return(0,a.jsxs)("button",{onClick:()=>v(e),className:`
./.next/static/chunks/8798-670965d53dfc94e2.js:"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8798],{78798:function(e,t,s){s.d(t,{jd:function(){return eO}});var a=s(57437),r=s(2265),l=s(20973),n=s(21654),c=s(62442),i=s(85790),o=s(56224),d=s(82549),x=s(45367);let m={warmup:{color:"modality-warmup",label:"Calentamiento"},strength_linear:{color:"modality-strength",label:"Fuerza"},metcon_structured:{color:"modality-metcon",label:"MetCon"},accessory:{color:"modality-accessory",label:"Accesorio"},skill:{color:"modality-skill",label:"Habilidad"},free_text:{color:"border-l-4 border-l-gray-500",label:"Notas"}},p={AMRAP:"AMRAP",EMOM:"EMOM",RFT:"Rondas Por Tiempo",Chipper:"Chipper",Ladder:"Ladder",Tabata:"Tabata","Not For Time":"Sin Tiempo","For Time":"Por Tiempo"};function b(e){let{block:t}=e,{selectBlock:s,selectedBlockId:b,deleteBlock:u,deleteProgression:h,duplicateBlock:g,enterBlockBuilder:v}=(0,l.E)(),[f,j]=(0,r.useState)(!1),[y,N]=(0,r.useState)(!1),k=b===t.id,w=m[t.type]||m.free_text,C=t.config,z=()=>{switch(t.type){case"strength_linear":let e=C.sets,s=C.reps,a=C.exercise;return!e&&!s&&!a;case"metcon_structured":let r=t.format,l=C.movements||[],n=C.time_cap;return!r&&0===l.length&&!n;case"free_text":let c=C.content;return!c||""===c.trim();case"warmup":case"accessory":case"skill":let i=C.exercises||[],o=C.notes;return 0===i.length&&(!o||""===o.trim());default:let d=Object.keys(C).filter(e=>"is_completed"!==e);return 0===d.length||d.every(e=>{let t=C[e];return null==t||""===t||Array.isArray(t)&&0===t.length})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"\n        group relative bg-cv-bg-tertiary rounded-lg p-2 cursor-pointer\n        transition-all hover:bg-cv-bg-elevated\n        ".concat(w.color,"\n        ").concat(k?"ring-2 ring-cv-accent":"","\n      "),onClick:e=>{e.stopPropagation(),s(t.id),v(t.day_id)},children:[(0,a.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-grab",children:(0,a.jsx)(n.Z,{size:12,className:"text-cv-text-tertiary"})}),(0,a.jsxs)("div",{className:"pl-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xs uppercase tracking-wider text-cv-text-tertiary font-medium",children:t.name||w.label}),!!C.is_completed&&(0,a.jsx)("div",{title:"Bloque completado",children:(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-emerald-500 flex items-center justify-center",children:(0,a.jsx)(c.Z,{size:8,className:"text-white stroke-[3]"})})}),t.progression_id&&(0,a.jsx)("div",{title:"Progresi\xf3n vinculada",children:(0,a.jsx)(i.Z,{size:10,className:"text-cv-accent"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),g(t.id)},className:"p-1 rounded hover:bg-cv-bg-secondary text-cv-text-tertiary hover:text-cv-text-primary",title:"Duplicar",children:(0,a.jsx)(o.Z,{size:12})}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),t.progression_id?j(!0):z()?u(t.id):N(!0)},className:"p-1 rounded hover:bg-red-100 dark:hover:bg-red-900/30 text-cv-text-tertiary hover:text-red-500",title:"Eliminar",children:(0,a.jsx)(d.Z,{size:14,className:"stroke-[2.5]"})})]})]}),(()=>{switch(t.type){case"strength_linear":let e=C.sets,s=C.reps,r=C.percentage;return(0,a.jsxs)("div",{className:"text-sm",children:[e&&s?"".concat(e," x ").concat(s):"Configurar...",r&&(0,a.jsxs)("span",{className:"text-cv-accent ml-1",children:["@ ",r]})]});case"metcon_structured":let l=t.format,n=C.movements||[];return(0,a.jsxs)("div",{children:[l&&(0,a.jsx)("span",{className:"cv-badge-accent mb-1",children:p[l]||l}),n.length>0&&(0,a.jsxs)("div",{className:"text-xs text-cv-text-tertiary mt-1 truncate",children:[n.slice(0,2).join(", "),n.length>2&&" +".concat(n.length-2," m\xe1s")]}),!l&&0===n.length&&(0,a.jsx)("span",{className:"text-cv-text-tertiary text-xs",children:"Configurar entreno..."})]});case"free_text":let c=C.content;return(0,a.jsx)("div",{className:"text-xs text-cv-text-tertiary truncate",children:c||"A\xf1adir notas..."});default:return(0,a.jsx)("span",{className:"text-cv-text-tertiary text-xs",children:"Configurar..."})}})()]})]}),f&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"bg-white dark:bg-cv-bg-secondary rounded-xl shadow-xl max-w-sm w-full overflow-hidden border border-slate-200 dark:border-slate-700 animate-in fade-in zoom-in-95 duration-200",children:[(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-cv-text-primary mb-2 flex items-center gap-2",children:[(0,a.jsx)(i.Z,{size:20,className:"text-cv-accent"}),"Eliminar Progresi\xf3n"]}),(0,a.jsx)("p",{className:"text-sm text-cv-text-secondary mb-4",children:"Este bloque es parte de una progresi\xf3n. \xbfQu\xe9 deseas hacer?"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),h(t.progression_id),j(!1)},className:"w-full flex items-center justify-between p-3 rounded-lg border border-red-200 bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:border-red-800 dark:hover:bg-red-900/30 transition-colors text-red-700 dark:text-red-400 text-sm font-medium",children:[(0,a.jsx)("span",{children:"Eliminar TODA la progresi\xf3n"}),(0,a.jsx)(x.Z,{size:16})]}),(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),u(t.id),j(!1)},className:"w-full flex items-center justify-between p-3 rounded-lg border border-slate-200 hover:bg-slate-50 dark:border-slate-700 dark:hover:bg-slate-800 transition-colors text-cv-text-primary text-sm font-medium",children:[(0,a.jsx)("span",{children:"Eliminar solo este bloque"}),(0,a.jsx)(x.Z,{size:16})]})]})]}),(0,a.jsx)("div",{className:"bg-slate-50 dark:bg-cv-bg-tertiary/50 p-3 flex justify-end",children:(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),j(!1)},className:"px-4 py-2 text-sm text-cv-text-secondary hover:text-cv-text-primary font-medium",children:"Cancelar"})})]})}),y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e=>e.stopPropagation(),children:(0,a.jsx)("div",{className:"bg-white dark:bg-cv-bg-secondary rounded-xl shadow-xl max-w-sm w-full overflow-hidden border border-slate-200 dark:border-slate-700 animate-in fade-in zoom-in-95 duration-200",children:(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-cv-text-primary mb-2 flex items-center gap-2",children:[(0,a.jsx)(x.Z,{size:20,className:"text-red-500"}),"\xbfEliminar bloque?"]}),(0,a.jsx)("p",{className:"text-sm text-cv-text-secondary mb-4",children:"Este bloque tiene contenido. \xbfEst\xe1s seguro de que deseas eliminarlo?"}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),N(!1)},className:"px-4 py-2 text-sm text-cv-text-secondary hover:text-cv-text-primary font-medium rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),u(t.id),N(!1)},className:"px-4 py-2 text-sm bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors",children:"Eliminar"})]})]})})})]})}var u=s(93088),h=s(9883),g=s(17472),v=s(44135),f=s(66654),j=s(39845);let y=[{type:"warmup",label:"Calentamiento",color:"bg-green-500"},{type:"strength_linear",label:"Fuerza",color:"bg-red-500"},{type:"metcon_structured",label:"MetCon",color:"bg-cv-accent"},{type:"accessory",label:"Accesorio",color:"bg-purple-500"},{type:"skill",label:"Habilidad",color:"bg-blue-500"},{type:"free_text",label:"Texto Libre",color:"bg-gray-500"}];function N(e){let{day:t,dayName:s,compact:r=!1,isActiveInBuilder:n=!1}=e,{addBlock:c,toggleRestDay:i,selectDay:o,selectBlock:d,selectedDayId:m,dropTargetDayId:p,updateDay:N,stimulusFeatures:k,clearDay:w,enterBlockBuilder:C,blockBuilderMode:z}=(0,l.E)(),Z=m===t.id,_=p===t.id,E=t.stimulus_id?k.find(e=>e.id===t.stimulus_id):null,S=e=>{e.stopPropagation(),C(t.id)};return r?(0,a.jsxs)("div",{className:"\n                    cv-card h-full min-h-[100px] flex flex-col p-2.5\n                    ".concat(n?"ring-2 ring-cv-accent shadow-lg bg-cv-accent/5":"bg-white dark:bg-cv-bg-secondary","\n                    ").concat(t.is_rest_day?"opacity-60":"","\n                    transition-all duration-200\n                "),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,a.jsx)("h4",{className:"text-xs font-bold text-cv-text-primary truncate",children:s}),n&&(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-cv-accent animate-pulse"})]}),t.is_rest_day?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsx)(u.Z,{size:14,className:"text-slate-400"})}):(0,a.jsxs)("div",{className:"flex-1 flex flex-col gap-0.5 overflow-hidden",children:[t.blocks.length>0?t.blocks.slice(0,3).map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-slate-50 dark:bg-slate-800/50 rounded text-[10px] text-cv-text-secondary truncate",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 rounded-full ".concat((null===(t=y.find(t=>t.type===e.type))||void 0===t?void 0:t.color)||"bg-slate-400")}),(0,a.jsx)("span",{className:"truncate",children:e.name||e.type})]},e.id)}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-cv-text-tertiary",children:(0,a.jsx)(h.Z,{size:12,className:"opacity-40"})}),t.blocks.length>3&&(0,a.jsxs)("p",{className:"text-[9px] text-cv-text-tertiary text-center",children:["+",t.blocks.length-3," m\xe1s"]})]})]}):t.is_rest_day?(0,a.jsxs)("div",{className:"\n                    cv-card h-full flex flex-col p-4 \n                    bg-gradient-to-br from-slate-50/50 to-slate-100/30 dark:from-slate-800/30 dark:to-slate-900/20\n                    border-slate-200 dark:border-slate-700\n                    ".concat(Z?"ring-2 ring-cv-accent":"","\n                    transition-all duration-200 cursor-pointer\n                "),onClick:()=>o(t.id),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4 pb-3 border-b border-slate-200 dark:border-slate-700",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-bold text-cv-text-primary",children:s}),(0,a.jsxs)("p",{className:"text-xs text-cv-text-tertiary",children:["D\xeda ",t.day_number]})]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"cv-btn-ghost p-1.5 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Editar d\xeda",children:(0,a.jsx)(g.Z,{size:16})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center text-cv-text-tertiary",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-3",children:(0,a.jsx)(u.Z,{size:28,className:"text-slate-400"})}),(0,a.jsx)("p",{className:"text-sm font-medium text-slate-500",children:"D\xeda de Descanso"}),(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"mt-4 flex items-center gap-1.5 text-xs text-cv-accent hover:text-cv-accent/80 transition-colors",children:[(0,a.jsx)(v.Z,{size:12}),"Convertir a entrenamiento"]})]})]}):(0,a.jsxs)("div",{className:"\n                cv-card h-full flex flex-col p-4 relative overflow-hidden\n                ".concat(Z?"ring-2 ring-cv-accent shadow-lg":"","\n                ").concat(_?"cv-drop-target ring-2 ring-cv-accent/50":"","\n                transition-all duration-200 cursor-pointer hover:shadow-md\n            "),onClick:()=>!n&&o(t.id),style:E?{borderColor:E.color+"40"}:{},children:[E&&(0,a.jsx)("div",{className:"absolute inset-x-0 top-0 h-24 opacity-15 pointer-events-none blur-xl z-0",style:{backgroundColor:E.color}}),(0,a.jsxs)("div",{className:"relative z-10 flex items-center justify-between mb-4 pb-3 border-b border-slate-200 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-base font-bold text-cv-text-primary",children:s}),t.blocks.length>0&&(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-cv-accent/10 text-cv-accent text-xs font-medium rounded-full",children:[t.blocks.length," ",1===t.blocks.length?"bloque":"bloques"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,a.jsxs)("p",{className:"text-xs text-cv-text-tertiary",children:["D\xeda ",t.day_number]}),E&&(0,a.jsx)("span",{className:"text-[10px] font-bold px-1.5 py-0.5 rounded border uppercase tracking-wider",style:{color:E.color,borderColor:E.color+"40",backgroundColor:E.color+"10"},children:E.name})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)(j.fC,{children:[(0,a.jsx)(j.xz,{asChild:!0,children:(0,a.jsx)("button",{className:"cv-btn-ghost p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",title:"Cambiar foco del d\xeda",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(f.Z,{size:14,className:E?"":"opacity-40",style:E?{color:E.color}:{}})})}),(0,a.jsx)(j.h_,{children:(0,a.jsxs)(j.VY,{className:"min-w-[220px] bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 p-2 z-50 animate-in fade-in zoom-in-95 duration-200",sideOffset:5,children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-cv-text-tertiary mb-2 px-2",children:"Foco / Est\xedmulo"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("button",{onClick:()=>N(t.id,{stimulus_id:null}),className:"w-full text-left px-2 py-1.5 text-sm rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-cv-text-secondary flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full border border-slate-300 dark:border-slate-600"}),(0,a.jsx)("span",{children:"Sin asignar"})]}),k.map(e=>(0,a.jsxs)("button",{onClick:()=>N(t.id,{stimulus_id:e.id}),className:"w-full text-left px-2 py-1.5 text-sm rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-cv-text-primary flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{children:e.name})]},e.id)),0===k.length&&(0,a.jsx)("p",{className:"text-xs text-cv-text-tertiary px-2 italic",children:"Configura est\xedmulos en ajustes"})]}),(0,a.jsx)(j.Eh,{className:"fill-white dark:fill-slate-900 border-t border-l border-slate-200 dark:border-slate-700"})]})})]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"cv-btn-ghost p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors opacity-60 hover:opacity-100",title:"Marcar como descanso",children:(0,a.jsx)(u.Z,{size:14})}),(0,a.jsxs)(j.fC,{children:[(0,a.jsx)(j.xz,{asChild:!0,children:(0,a.jsx)("button",{className:"cv-btn-ghost p-1.5 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",title:"M\xe1s opciones",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(g.Z,{size:16})})}),(0,a.jsx)(j.h_,{children:(0,a.jsxs)(j.VY,{className:"min-w-[180px] bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 p-1 z-50 animate-in fade-in zoom-in-95 duration-200",sideOffset:5,align:"end",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),w(t.id)},className:"w-full text-left px-2 py-2 text-sm rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 flex items-center gap-2 transition-colors",children:[(0,a.jsx)(x.Z,{size:14}),(0,a.jsx)("span",{children:"Limpiar contenido"})]}),(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"w-full text-left px-2 py-2 text-sm rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-cv-text-secondary flex items-center gap-2 transition-colors",children:[(0,a.jsx)(u.Z,{size:14}),(0,a.jsx)("span",{children:"Marcar como descanso"})]})]}),(0,a.jsx)(j.Eh,{className:"fill-white dark:fill-slate-900 border-t border-l border-slate-200 dark:border-slate-700"})]})})]})]})]}),(0,a.jsxs)("div",{className:"flex-1 space-y-3 mb-4 overflow-y-auto",children:[t.blocks.sort((e,t)=>e.order_index-t.order_index).map(e=>(0,a.jsx)("div",{className:"bg-white dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow transition-shadow cursor-pointer",onClick:s=>{s.stopPropagation(),d(e.id),C(t.id)},children:(0,a.jsx)(b,{block:e})},e.id)),0===t.blocks.length&&(0,a.jsxs)("div",{className:"h-32 bg-slate-50 dark:bg-slate-800/30 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-xl flex flex-col items-center justify-center text-cv-text-tertiary cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800/50 hover:border-cv-accent/50 transition-colors",onClick:S,children:[(0,a.jsx)(h.Z,{size:20,className:"mb-2 opacity-40"}),(0,a.jsx)("p",{className:"text-sm",children:"A\xfan no hay bloques"}),(0,a.jsx)("p",{className:"text-xs opacity-60 mt-1",children:"Click para a\xf1adir"})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)("button",{className:"w-full py-2.5 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl text-cv-text-secondary hover:text-cv-accent hover:border-cv-accent hover:bg-cv-accent/5 transition-all flex items-center justify-center gap-2 font-medium",onClick:S,children:[(0,a.jsx)(h.Z,{size:16}),(0,a.jsx)("span",{className:"text-sm",children:"A\xf1adir Bloque"})]})})]})}var k=s(39930),w=s(6141),C=s(67842);function z(e){let{mesocycle:t,programGlobalFocus:s}=e,r=t.days.reduce((e,t)=>e+t.blocks.length,0),l=t.days.filter(e=>e.blocks.length>0).length,n=t.days.reduce((e,t)=>e+t.blocks.filter(e=>"strength_linear"===e.type).length,0),c=t.days.reduce((e,t)=>e+t.blocks.filter(e=>"metcon_structured"===e.type).length,0),o=t.attributes||{},d=o.considerations||"",x=o.focus||t.focus||"";return(0,a.jsxs)("div",{className:"cv-card h-full flex flex-col bg-gradient-to-br from-slate-50/80 to-slate-100/50 dark:from-slate-800/50 dark:to-slate-900/30 border-slate-200 dark:border-slate-700",children:[s&&(0,a.jsxs)("div",{className:"mb-4 p-3 rounded-xl bg-gradient-to-r from-cv-accent/15 via-purple-500/10 to-cv-accent/5 border border-cv-accent/20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(k.Z,{size:14,className:"text-cv-accent"}),(0,a.jsx)("span",{className:"text-xs font-semibold text-cv-accent uppercase tracking-wide",children:"\uD83C\uDFAF Objetivo del Mesociclo"})]}),(0,a.jsx)("p",{className:"text-sm font-medium text-cv-text-primary leading-snug whitespace-pre-wrap",children:s})]}),(0,a.jsx)("div",{className:"flex items-center justify-between mb-3 pb-3 border-b border-slate-200 dark:border-slate-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-cv-accent/10 flex items-center justify-center",children:(0,a.jsx)(f.Z,{size:16,className:"text-cv-accent"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-cv-text-primary",children:"Resumen Semanal"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-cv-text-tertiary",children:[(0,a.jsxs)("span",{children:["Semana ",t.week_number]}),x&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"w-1 h-1 rounded-full bg-cv-text-tertiary/40"}),(0,a.jsx)("span",{className:"text-cv-accent font-medium",children:x})]})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,a.jsxs)("div",{className:"bg-white/60 dark:bg-slate-800/40 rounded-lg p-3 border border-slate-100 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-cv-text-tertiary mb-1",children:[(0,a.jsx)(w.Z,{size:12}),(0,a.jsx)("span",{className:"text-xs",children:"D\xedas Entrenamiento"})]}),(0,a.jsxs)("p",{className:"text-xl font-bold text-cv-text-primary",children:[l,(0,a.jsx)("span",{className:"text-sm font-normal text-cv-text-tertiary",children:"/7"})]})]}),(0,a.jsxs)("div",{className:"bg-white/60 dark:bg-slate-800/40 rounded-lg p-3 border border-slate-100 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-cv-text-tertiary mb-1",children:[(0,a.jsx)(C.Z,{size:12}),(0,a.jsx)("span",{className:"text-xs",children:"Total Bloques"})]}),(0,a.jsx)("p",{className:"text-xl font-bold text-cv-text-primary",children:r})]}),(0,a.jsxs)("div",{className:"bg-white/60 dark:bg-slate-800/40 rounded-lg p-3 border border-slate-100 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-500 mb-1",children:[(0,a.jsx)(i.Z,{size:12}),(0,a.jsx)("span",{className:"text-xs",children:"Fuerza"})]}),(0,a.jsx)("p",{className:"text-xl font-bold text-cv-text-primary",children:n})]}),(0,a.jsxs)("div",{className:"bg-white/60 dark:bg-slate-800/40 rounded-lg p-3 border border-slate-100 dark:border-slate-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-cv-accent mb-1",children:[(0,a.jsx)(i.Z,{size:12}),(0,a.jsx)("span",{className:"text-xs",children:"MetCon"})]}),(0,a.jsx)("p",{className:"text-xl font-bold text-cv-text-primary",children:c})]})]}),d&&(0,a.jsx)("div",{className:"flex-1 bg-white/60 dark:bg-slate-800/40 rounded-lg p-3 border border-slate-100 dark:border-slate-700",children:d&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs font-medium text-cv-text-tertiary",children:"Notas:"}),(0,a.jsx)("p",{className:"text-xs text-cv-text-secondary mt-0.5 line-clamp-3",children:d})]})}),!x&&!d&&!s&&(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-cv-text-tertiary",children:(0,a.jsxs)("p",{className:"text-xs text-center",children:['Usa "Estrategia" para a\xf1adir',(0,a.jsx)("br",{}),"notas de enfoque semanal"]})})]})}let Z=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"];function _(e){let{mesocycle:t,programGlobalFocus:s,compressed:r=!1}=e,{blockBuilderDayId:n}=(0,l.E)(),c=Array.from({length:7},(e,s)=>{let a=s+1;return t.days.find(e=>e.day_number===a)||{id:"placeholder-".concat(t.id,"-").concat(a),mesocycle_id:t.id,day_number:a,name:null,is_rest_day:!1,notes:null,blocks:[]}});if(r)return(0,a.jsx)("div",{className:"h-full flex flex-col p-2",children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 auto-rows-fr",children:c.map((e,t)=>(0,a.jsx)(N,{day:e,dayName:Z[t],compact:!0,isActiveInBuilder:e.id===n},e.id))})});let i=c.slice(0,4),o=c.slice(4,7);return(0,a.jsx)("div",{className:"h-full flex flex-col",children:(0,a.jsxs)("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 grid-rows-[repeat(auto-fit,minmax(0,1fr))] xl:grid-rows-2 gap-4 min-h-0",children:[i.map((e,t)=>(0,a.jsx)(N,{day:e,dayName:Z[t]},e.id)),o.map((e,t)=>(0,a.jsx)(N,{day:e,dayName:Z[t+4]},e.id)),(0,a.jsx)(z,{mesocycle:t,programGlobalFocus:s})]})})}var E=s(28203),S=s(83523);let A=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"];function M(e){let{mesocycle:t,dayId:s,onSelectDay:l}=e,n=(0,r.useMemo)(()=>Array.from({length:7},(e,s)=>{let a=s+1;return t.days.find(e=>e.day_number===a)||{id:"placeholder-".concat(t.id,"-").concat(a),tempId:"placeholder-".concat(t.id,"-").concat(a),mesocycle_id:t.id,day_number:a,name:null,is_rest_day:!1,notes:null,stimulus_id:null,blocks:[],isDirty:!1}}),[t]),c=n.find(e=>e.id===s)||n[0],i=c.day_number-1;return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-slate-50/50 dark:bg-cv-bg-primary/50",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary flex items-center justify-between shadow-sm z-10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-cv-accent/10 rounded-lg text-cv-accent",children:(0,a.jsx)(E.Z,{size:20})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("label",{className:"text-[10px] uppercase font-bold text-cv-text-tertiary tracking-wider",children:"D\xeda Seleccionado"}),(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("select",{value:s,onChange:e=>l(e.target.value),className:"appearance-none bg-transparent font-bold text-lg text-cv-text-primary pr-8 cursor-pointer focus:outline-none",children:n.map((e,t)=>(0,a.jsx)("option",{value:e.id,children:A[t]},e.id))}),(0,a.jsx)(S.Z,{size:16,className:"absolute right-0 top-1/2 -translate-y-1/2 text-cv-text-secondary pointer-events-none"})]})]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-xs text-cv-text-tertiary",children:["Semana ",t.week_number]})})]}),(0,a.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:(0,a.jsx)("div",{className:"h-full max-w-2xl mx-auto",children:(0,a.jsx)(N,{day:c,dayName:A[i],isActiveInBuilder:!0})})})]})}var P=s(25727),D=s(86264),T=s(41827),R=s(45787);let F=["Weightlifting","Gymnastics","Monostructural","Functional Bodybuilding"];function I(e){let{isOpen:t,onClose:s,initialName:l="",onSuccess:n}=e,[c,i]=(0,r.useState)(!1),[o,x]=(0,r.useState)(null),[m,p]=(0,r.useState)(l),[b,u]=(0,r.useState)("Weightlifting"),[g,v]=(0,r.useState)(""),[f,j]=(0,r.useState)([]),[y,N]=(0,r.useState)([]),[k,w]=(0,r.useState)(""),[C,z]=(0,r.useState)(""),[Z,_]=(0,r.useState)(""),[E,S]=(0,r.useState)(""),A=(e,t,s,a)=>{e.trim()&&!t.includes(e.trim())&&(s([...t,e.trim()]),a(""))},M=(e,t,s)=>{s(t.filter((t,s)=>s!==e))},T=async e=>{if(e.preventDefault(),x(null),!m.trim()){x("El nombre es obligatorio");return}i(!0);try{let e=await (0,P.hT)({name:m,category:b,subcategory:g||void 0,equipment:f,modality_suitability:y,video_url:k||void 0,description:C||void 0});e.error?x(e.error):e.data&&(n(e.data.name),s())}catch(e){x("Error al crear el ejercicio"),console.error(e)}finally{i(!1)}};return(0,a.jsx)(R.u,{isOpen:t,onClose:s,title:"Crear Nuevo Ejercicio",description:"A\xf1ade un ejercicio a la biblioteca global.",maxWidth:"max-w-2xl",children:(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4 text-cv-text-primary",children:[o&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/20 text-red-500 p-3 rounded-lg text-sm",children:o}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Nombre"}),(0,a.jsx)("input",{type:"text",value:m,onChange:e=>p(e.target.value),className:"cv-input w-full",placeholder:"Ej: Push Press",autoFocus:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Categor\xeda"}),(0,a.jsx)("select",{value:b,onChange:e=>u(e.target.value),className:"cv-input w-full",children:F.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Subcategor\xeda (Opcional)"}),(0,a.jsx)("input",{type:"text",value:g,onChange:e=>v(e.target.value),className:"cv-input w-full",placeholder:"Ej: Overhead, Squat..."})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Equipamiento"}),(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:Z,onChange:e=>_(e.target.value),onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),A(Z,f,j,_)),className:"cv-input flex-1",placeholder:"Ej: Barbell, Dumbbell (Enter para a\xf1adir)"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(Z,f,j,_),className:"bg-cv-bg-elevated border border-cv-border p-2 rounded-lg hover:bg-cv-bg-tertiary",children:(0,a.jsx)(h.Z,{size:20})})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:f.map((e,t)=>(0,a.jsxs)("span",{className:"bg-cv-bg-tertiary px-2 py-1 rounded-md text-xs flex items-center gap-1",children:[e,(0,a.jsx)("button",{type:"button",onClick:()=>M(t,f,j),className:"hover:text-red-400",children:(0,a.jsx)(d.Z,{size:12})})]},t))})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Modalidades (Suitability)"}),(0,a.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,a.jsx)("input",{type:"text",value:E,onChange:e=>S(e.target.value),onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),A(E,y,N,S)),className:"cv-input flex-1",placeholder:"Ej: Strength, Metcon, hypertrophy (Enter para a\xf1adir)"}),(0,a.jsx)("button",{type:"button",onClick:()=>A(E,y,N,S),className:"bg-cv-bg-elevated border border-cv-border p-2 rounded-lg hover:bg-cv-bg-tertiary",children:(0,a.jsx)(h.Z,{size:20})})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map((e,t)=>(0,a.jsxs)("span",{className:"bg-cv-bg-tertiary px-2 py-1 rounded-md text-xs flex items-center gap-1",children:[e,(0,a.jsx)("button",{type:"button",onClick:()=>M(t,y,N),className:"hover:text-red-400",children:(0,a.jsx)(d.Z,{size:12})})]},t))})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"URL Video (Youtube/Vimeo)"}),(0,a.jsx)("input",{type:"url",value:k,onChange:e=>w(e.target.value),className:"cv-input w-full",placeholder:"https://..."})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-1",children:"Descripci\xf3n / Notas"}),(0,a.jsx)("textarea",{value:C,onChange:e=>z(e.target.value),className:"cv-input w-full min-h-[80px]",placeholder:"Instrucciones t\xe9cnicas..."})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-white/5",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-cv-text-secondary hover:text-cv-text-primary transition-colors",children:"Cancelar"}),(0,a.jsxs)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-cv-accent text-white rounded-lg text-sm font-medium hover:bg-cv-accent/90 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c&&(0,a.jsx)(D.Z,{size:16,className:"animate-spin"}),"Guardar Ejercicio"]})]})]})})}function q(e){let{value:t,onChange:s,placeholder:l="Buscar ejercicio...",className:n,autoFocus:c,inputRef:i}=e,[o,d]=(0,r.useState)(t),[x,m]=(0,r.useState)([]),[p,b]=(0,r.useState)(!1),[u,g]=(0,r.useState)(!1),[v,f]=(0,r.useState)(!1),j=(0,r.useRef)(null),y=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=setTimeout(async()=>{if(o.trim().length<2){m([]);return}g(!0);try{let e=await (0,P.Gv)(o);m(e||[])}catch(e){console.error(e),m([])}finally{g(!1)}},300);return()=>clearTimeout(e)},[o]),(0,r.useEffect)(()=>{d(t)},[t]),(0,r.useEffect)(()=>{function e(e){y.current&&!y.current.contains(e.target)&&b(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let N=e=>{d(e),s(e),b(!1)},k=x.some(e=>e.name.toLowerCase()===o.trim().toLowerCase());return(0,a.jsxs)("div",{ref:y,className:"relative w-full",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{ref:i||j,type:"text",value:o,onChange:e=>{d(e.target.value),b(!0),s(e.target.value)},onFocus:()=>{o.trim().length>=2&&b(!0)},placeholder:l,className:"".concat(n," pr-8"),autoFocus:c,autoComplete:"off"}),(0,a.jsx)("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-cv-text-tertiary",children:u?(0,a.jsx)(D.Z,{size:14,className:"animate-spin"}):(0,a.jsx)(T.Z,{size:14})})]}),p&&o.trim().length>=2&&(0,a.jsxs)("div",{className:"absolute z-50 w-full mt-1 bg-cv-bg-elevated border border-cv-border rounded-lg shadow-cv-lg max-h-80 overflow-y-auto transform transition-all",children:[x.length>0&&(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("div",{className:"px-3 py-1.5 text-xs font-semibold text-cv-text-tertiary uppercase tracking-wider",children:"Ejercicios"}),x.map(e=>(0,a.jsxs)("button",{onClick:()=>N(e.name),className:"w-full text-left px-3 py-2 text-sm text-cv-text-secondary hover:bg-cv-bg-tertiary hover:text-cv-text-primary transition-colors flex flex-col gap-0.5 border-b border-white/5 last:border-0",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-cv-text-tertiary",children:[e.category," ",e.subcategory?"â€¢ ".concat(e.subcategory):""]})]},e.id))]}),!k&&!u&&(0,a.jsx)("div",{className:"p-2 ".concat(x.length>0?"border-t border-cv-border":""),children:(0,a.jsxs)("button",{onClick:()=>{b(!1),f(!0)},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-cv-accent/10 text-cv-accent hover:bg-cv-accent/20 transition-colors text-left",children:[(0,a.jsx)("div",{className:"bg-cv-accent/20 p-1.5 rounded-md",children:(0,a.jsx)(h.Z,{size:16})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold",children:['Crear "',o,'"']}),(0,a.jsx)("span",{className:"text-xs opacity-80",children:"A\xf1adir a la biblioteca global"})]})]})}),0===x.length&&!u&&(0,a.jsx)("div",{className:"px-4 py-3 text-center text-sm text-cv-text-tertiary",children:"No se encontraron ejercicios similares."})]}),(0,a.jsx)(I,{isOpen:v,onClose:()=>f(!1),initialName:o,onSuccess:e=>{d(e),s(e),f(!1)}})]})}var O=s(46232),B=s(68291);function L(e){let{config:t,onChange:s}=e,l=t.minutes||10,n=t.interval||1,[c,i]=(0,r.useState)(()=>{let e=t.slots;if(e&&Array.isArray(e))return e;let s=t.movements||[];return s.length>0?s.map((e,t)=>({id:crypto.randomUUID(),label:"Minuto ".concat(t+1),movement:e,reps:""})):[{id:crypto.randomUUID(),label:"Minuto 1",movement:"",reps:""}]});(0,r.useEffect)(()=>{s("slots",c),s("movements",c.map(e=>e.movement))},[c]);let o=e=>{i(t=>t.filter((t,s)=>s!==e))},d=(e,t,s)=>{i(a=>{let r=[...a];return r[e]={...r[e],[t]:s},r})};return(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-300",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 bg-slate-50 dark:bg-cv-bg-tertiary/30 p-4 rounded-xl border border-slate-200 dark:border-slate-700/50",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[120px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Duraci\xf3n Total"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(w.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:l,onChange:e=>s("minutes",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary",placeholder:"10"})]}),(0,a.jsx)("span",{className:"text-sm font-medium text-cv-text-tertiary",children:"min"})]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[120px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Cada"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(O.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:n,onChange:e=>s("interval",parseInt(e.target.value)||1),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary",placeholder:"1"})]}),(0,a.jsx)("span",{className:"text-sm font-medium text-cv-text-tertiary",children:"min"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-cv-text-secondary",children:"Distribuci\xf3n de Minutos"}),(0,a.jsxs)("span",{className:"text-xs text-cv-text-tertiary bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-md",children:[c.length," intervalos definidos"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:c.map((e,t)=>(0,a.jsxs)("div",{className:"group relative flex gap-3 p-3 bg-white dark:bg-cv-bg-secondary border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm hover:shadow-md hover:border-cv-accent/30 transition-all items-start",children:[(0,a.jsxs)("div",{className:"w-24 pt-1",children:[(0,a.jsx)("input",{type:"text",value:e.label,onChange:e=>d(t,"label",e.target.value),className:"w-full text-xs font-bold text-cv-accent bg-cv-accent/5 border border-cv-accent/20 rounded-md px-2 py-1.5 text-center focus:ring-1 focus:ring-cv-accent focus:bg-white transition-all uppercase tracking-wide",placeholder:"MIN 1"}),t<c.length-1&&(0,a.jsx)("div",{className:"flex justify-center my-1",children:(0,a.jsx)("div",{className:"w-0.5 h-6 bg-slate-100 dark:bg-slate-700/50"})})]}),(0,a.jsx)("div",{className:"pt-2 text-slate-300 dark:text-slate-600",children:(0,a.jsx)(B.Z,{size:16})}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(q,{value:e.movement,onChange:e=>d(t,"movement",e),placeholder:"Buscar ejercicio...",className:"cv-input bg-transparent border-none shadow-none focus:ring-0 px-0 py-0 text-sm font-medium h-auto placeholder:text-slate-400"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("input",{type:"text",value:e.reps,onChange:e=>d(t,"reps",e.target.value),placeholder:"Ej: 15 reps, 40 segs work...",className:"text-xs text-cv-text-secondary bg-slate-50 dark:bg-slate-800 border-none rounded-md px-2 py-1 flex-1 focus:ring-1 focus:ring-cv-accent/50"})})]}),(0,a.jsx)("button",{onClick:()=>o(t),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",title:"Eliminar intervalo",children:(0,a.jsx)(x.Z,{size:16})})]},e.id||t))}),(0,a.jsxs)("button",{onClick:()=>{i(e=>[...e,{id:crypto.randomUUID(),label:"Minuto ".concat(e.length+1),movement:"",reps:""}])},className:"mt-3 w-full py-3 border border-dashed border-cv-border rounded-xl text-cv-text-tertiary hover:text-cv-accent hover:border-cv-accent/50 hover:bg-cv-accent/5 transition-all flex items-center justify-center gap-2 text-sm font-medium",children:[(0,a.jsx)(h.Z,{size:16}),"A\xf1adir Intervalo"]})]})]})}var U=s(23086);function G(e){let{config:t,onChange:s,mode:l}=e,[n,c]=(0,r.useState)(()=>{let e=t.items;if(e&&Array.isArray(e))return e;let s=t.movements||[];return s.length>0?s.map(e=>({id:crypto.randomUUID(),exercise:e,reps:""})):[{id:crypto.randomUUID(),exercise:"",reps:""}]});(0,r.useEffect)(()=>{s("items",n),s("movements",n.map(e=>e.exercise))},[n]);let i=e=>{c(t=>t.filter((t,s)=>s!==e))},o=(e,t,s)=>{c(a=>{let r=[...a];return r[e]={...r[e],[t]:s},r})};return(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-300",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 bg-slate-50 dark:bg-cv-bg-tertiary/30 p-4 rounded-xl border border-slate-200 dark:border-slate-700/50",children:["AMRAP"===l&&(0,a.jsxs)("div",{className:"flex-1 min-w-[140px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Time Cap / Duraci\xf3n"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(w.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:t.minutes||"",onChange:e=>s("minutes",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary",placeholder:"Minutos"})]})})]}),("RFT"===l||"CHIPPER"===l)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[120px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Rondas"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(U.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:t.rounds||"",onChange:e=>s("rounds",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary",placeholder:"CHIPPER"===l?"1":"5"})]})})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[140px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Time Cap (Opcional)"}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(w.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:t.timeCap||"",onChange:e=>s("timeCap",parseInt(e.target.value)||null),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary",placeholder:"No limit"})]})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-cv-text-secondary",children:"Ejercicios del Circuito"}),(0,a.jsxs)("span",{className:"text-xs text-cv-text-tertiary bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-md",children:[n.length," ejercicios"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:n.map((e,t)=>(0,a.jsxs)("div",{className:"group flex gap-3 p-3 bg-white dark:bg-cv-bg-secondary border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm hover:shadow-md transition-all items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-xs font-bold text-cv-text-tertiary shrink-0",children:t+1}),(0,a.jsx)("div",{className:"flex-1 space-y-1",children:(0,a.jsx)(q,{value:e.exercise,onChange:e=>o(t,"exercise",e),placeholder:"Buscar ejercicio...",className:"cv-input bg-transparent border-none shadow-none focus:ring-0 px-0 py-0 text-sm font-medium h-auto placeholder:text-slate-400"})}),(0,a.jsx)("div",{className:"w-24 shrink-0",children:(0,a.jsx)("input",{type:"text",value:e.reps,onChange:e=>o(t,"reps",e.target.value),placeholder:"Reps",className:"w-full text-sm text-center bg-slate-50 dark:bg-slate-800 border-none rounded-lg py-2 focus:ring-1 focus:ring-cv-accent/50"})}),(0,a.jsx)("button",{onClick:()=>i(t),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",children:(0,a.jsx)(x.Z,{size:16})})]},e.id||t))}),(0,a.jsxs)("button",{onClick:()=>{c(e=>[...e,{id:crypto.randomUUID(),exercise:"",reps:""}])},className:"mt-3 w-full py-3 border border-dashed border-cv-border rounded-xl text-cv-text-tertiary hover:text-cv-accent hover:border-cv-accent/50 hover:bg-cv-accent/5 transition-all flex items-center justify-center gap-2 text-sm font-medium",children:[(0,a.jsx)(h.Z,{size:16}),"A\xf1adir Ejercicio"]})]})]})}function H(e){let{config:t,onChange:s}=e,l=t.rounds||8,n=t.workSeconds||20,c=t.restSeconds||10,[i,o]=(0,r.useState)(()=>t.movements&&Array.isArray(t.movements)?t.movements:t.movement?[t.movement]:[""]);(0,r.useEffect)(()=>{s("movements",i),s("movement",i[0]||"")},[i]);let d=e=>{o(t=>t.filter((t,s)=>s!==e))},m=(e,t)=>{o(s=>{let a=[...s];return a[e]=t,a})},p=l*(n+c)-c;return(0,a.jsxs)("div",{className:"space-y-6 animate-in fade-in duration-300",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 bg-slate-50 dark:bg-cv-bg-tertiary/30 p-4 rounded-xl border border-slate-200 dark:border-slate-700/50",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[100px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide",children:"Rondas"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(U.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-cv-text-tertiary"}),(0,a.jsx)("input",{type:"number",value:l,onChange:e=>s("rounds",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-cv-accent/20 focus:border-cv-accent transition-all font-semibold text-cv-text-primary"})]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[120px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide text-green-600 dark:text-green-400",children:"Trabajo (s)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(w.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-green-500/70"}),(0,a.jsx)("input",{type:"number",value:n,onChange:e=>s("workSeconds",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-green-500/20 focus:border-green-500 transition-all font-semibold text-cv-text-primary"})]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-[120px]",children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-cv-text-secondary mb-1.5 uppercase tracking-wide text-orange-600 dark:text-orange-400",children:"Descanso (s)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(w.Z,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-orange-500/70"}),(0,a.jsx)("input",{type:"number",value:c,onChange:e=>s("restSeconds",parseInt(e.target.value)||0),className:"w-full pl-9 pr-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all font-semibold text-cv-text-primary"})]})]})]}),(0,a.jsxs)("div",{className:"text-xs text-cv-text-tertiary italic text-center",children:["Tiempo Total Estimado: ",Math.floor(p/60),":",(p%60).toString().padStart(2,"0")]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-cv-text-secondary",children:"Ejercicios Tabata"}),(0,a.jsxs)("span",{className:"text-xs text-cv-text-tertiary bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-md",children:[i.length," movimientos"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:i.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-3 p-3 bg-white dark:bg-cv-bg-secondary border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm transition-all items-center group",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-xs font-bold text-cv-text-tertiary shrink-0",children:String.fromCharCode(65+t)}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(q,{value:e,onChange:e=>m(t,e),placeholder:"Buscar ejercicio...",className:"cv-input bg-transparent border-none shadow-none focus:ring-0 px-0 py-0 text-sm font-medium h-auto placeholder:text-slate-400 w-full"})}),(0,a.jsx)("button",{onClick:()=>d(t),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",children:(0,a.jsx)(x.Z,{size:16})})]},t))}),(0,a.jsxs)("button",{onClick:()=>{o(e=>[...e,""])},className:"mt-3 w-full py-3 border border-dashed border-cv-border rounded-xl text-cv-text-tertiary hover:text-cv-accent hover:border-cv-accent/50 hover:bg-cv-accent/5 transition-all flex items-center justify-center gap-2 text-sm font-medium",children:[(0,a.jsx)(h.Z,{size:16}),"A\xf1adir Ejercicio Alternativo"]})]})]})}var V=s(84958),J=s(81016),W=s(52369),K=s(90998),Y=s(74522),X=s(17810),Q=s(62574),$=s(64280),ee=s(54455),et=s(16981),es=s(1088),ea=s(45479);let er={Clock:w.Z,Timer:V.Z,Flame:J.Z,Zap:W.Z,Dumbbell:C.Z,Activity:K.Z,TrendingUp:i.Z,TrendingDown:Y.Z,Heart:X.Z,Layers:Q.Z,RefreshCw:$.Z,Skull:ee.Z,ListOrdered:et.Z,Puzzle:es.Z,Repeat:O.Z,Repeat2:O.Z,HelpCircle:ea.Z};function el(e){let{blockId:t,autoFocusFirst:s=!0}=e,{mesocycles:n,updateBlock:i,selectBlock:o,deleteBlock:d,blockBuilderDayId:m,selectedDayId:p}=(0,l.E)(),[b,u]=(0,r.useState)([]),[h,g]=(0,r.useState)(!0),[v,f]=(0,r.useState)(null),j=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async function(){try{let e=await (0,P.EZ)();u(e)}catch(e){console.error("Error loading methodologies:",e)}finally{g(!1)}})()},[]),(0,r.useEffect)(()=>{s&&j.current&&setTimeout(()=>{var e;null===(e=j.current)||void 0===e||e.focus()},100)},[s,t]);let y=null;for(let e of n)for(let s of e.days){let e=s.blocks.find(e=>e.id===t);if(e){y=e;break}}let N=b.find(e=>e.code===(null==y?void 0:y.format));if((0,r.useEffect)(()=>{N&&!v&&f(N.category)},[N,v]),!y)return(0,a.jsx)("div",{className:"p-4 text-center text-cv-text-tertiary",children:"Bloque no encontrado"});let k=y.config||{},w=(e,s)=>{i(t,{config:{...k,[e]:s}})},z=e=>{let s=b.find(t=>t.code===e);s?i(t,{format:e,config:{...k,...s.default_values}}):i(t,{format:e})},Z=["metcon","hiit","conditioning"],_=Z.reduce((e,t)=>(e[t]=b.filter(e=>e.category===t),e),{}),E={metcon:"MetCon",hiit:"HIIT",strength:"Classic",conditioning:"Acondicionamiento"},S={metcon:W.Z,hiit:V.Z,strength:C.Z,conditioning:X.Z},A=m||p,M=null;for(let e of n){let t=e.days.findIndex(e=>e.id===A);if(-1!==t){M=e.days[t],e.days.filter(e=>!e.is_rest_day).length;break}}let D=M?[...M.blocks].sort((e,t)=>e.order_index-t.order_index):[],T=D.findIndex(e=>e.id===t),R=D.length,F=!!y&&("free_text"===y.type?!!(y.config||{}).content:!!(y.name&&y.name.trim().length>0));return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-slate-50 to-white dark:from-cv-bg-tertiary dark:to-cv-bg-secondary",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-cv-accent/10 flex items-center justify-center",children:(0,a.jsx)(C.Z,{size:16,className:"text-cv-accent"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-cv-text-primary",children:y.name||({warmup:"Calentamiento",strength_linear:"Classic",metcon_structured:"MetCon",accessory:"Accesorio",skill:"Habilidad",free_text:"Texto Libre"})[y.type]||"Bloque"}),(0,a.jsxs)("p",{className:"text-xs text-cv-text-tertiary",children:[T+1," de ",R," bloques"]})]})]}),(0,a.jsxs)("button",{onClick:()=>{F&&(i(t,{config:{...y.config,is_completed:!0}}),o(null))},disabled:!F,title:F?"Confirmar y cerrar":"Completa los campos requeridos (Sets/Reps, Movimientos, etc.)",className:"flex items-center gap-1.5 px-3 py-2 rounded-lg font-medium text-sm transition-colors shadow-sm\n                        ".concat(F?"bg-cv-accent text-white hover:bg-cv-accent/90":"bg-slate-200 dark:bg-slate-700 text-slate-400 dark:text-slate-500 cursor-not-allowed"),children:[(0,a.jsx)(c.Z,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"OK"})]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Nombre del Bloque / Ejercicio Principal"}),(0,a.jsx)(q,{value:y.name||"",onChange:e=>i(t,{name:e||null}),placeholder:"Buscar ejercicio...",className:"cv-input",inputRef:j})]}),("metcon_structured"===y.type||"warmup"===y.type||"accessory"===y.type)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Metodolog\xeda de Entrenamiento"}),h?(0,a.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-cv-accent"})}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 no-scrollbar",children:Z.map(e=>{let t=_[e]||[];if(0===t.length)return null;let s=v===e,r=t.some(e=>e.code===(null==y?void 0:y.format)),l=S[e]||C.Z;return(0,a.jsxs)("button",{onClick:()=>f(e),className:"\n                                                    flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-medium transition-all whitespace-nowrap border\n                                                    ".concat(s?"bg-cv-accent text-white border-cv-accent shadow-sm":r?"bg-cv-accent/10 text-cv-accent border-cv-accent/30 hover:bg-cv-accent/20":"bg-white dark:bg-cv-bg-secondary text-cv-text-secondary border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600","\n                                                "),children:[(0,a.jsx)(l,{size:14}),(0,a.jsx)("span",{children:E[e]})]},e)})}),v&&(0,a.jsx)("div",{className:"bg-slate-50 dark:bg-cv-bg-tertiary/50 p-3 rounded-xl border border-slate-200 dark:border-slate-700 animate-in fade-in slide-in-from-top-1 duration-200",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:(_[v]||[]).map(e=>{let t=er[e.icon]||C.Z,s=(null==y?void 0:y.format)===e.code;return(0,a.jsxs)("button",{onClick:()=>z(e.code),title:e.description,className:"\n                                                            px-3 py-2 rounded-lg text-xs font-medium transition-all\n                                                            flex items-center gap-2 border flex-1 min-w-[120px] justify-center\n                                                            ".concat(s?"bg-white dark:bg-cv-bg-primary text-cv-accent border-cv-accent shadow-sm ring-1 ring-cv-accent/20":"bg-white dark:bg-cv-bg-secondary text-cv-text-secondary hover:text-cv-text-primary hover:bg-slate-50 dark:hover:bg-cv-bg-primary border-slate-200 dark:border-slate-700","\n                                                        "),children:[(0,a.jsx)(t,{size:14}),e.name]},e.code)})})})]}),N&&(0,a.jsx)("p",{className:"mt-2 text-xs text-cv-text-tertiary italic",children:N.description})]}),N&&(0,a.jsxs)(a.Fragment,{children:["EMOM"===N.code&&(0,a.jsx)(L,{config:k,onChange:w}),"AMRAP"===N.code&&(0,a.jsx)(G,{mode:"AMRAP",config:k,onChange:w}),("RFT"===N.code||"For Time"===N.code)&&(0,a.jsx)(G,{mode:"RFT",config:k,onChange:w}),"Chipper"===N.code&&(0,a.jsx)(G,{mode:"CHIPPER",config:k,onChange:w}),"Tabata"===N.code&&(0,a.jsx)(H,{config:k,onChange:w}),!["EMOM","AMRAP","RFT","For Time","Chipper","Tabata"].includes(N.code)&&(0,a.jsx)(en,{methodology:N,config:k,onChange:w})]}),!N&&(0,a.jsxs)(a.Fragment,{children:["strength_linear"===y.type&&(0,a.jsx)(eo,{config:k,onChange:w}),"free_text"===y.type&&(0,a.jsx)(ed,{config:k,onChange:w}),("warmup"===y.type||"accessory"===y.type||"skill"===y.type)&&!y.format&&(0,a.jsx)(ex,{config:k,onChange:w})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Notas"}),(0,a.jsx)("textarea",{value:k.notes||"",onChange:e=>w("notes",e.target.value),placeholder:"Focus on quality, tempo, etc.",className:"cv-input min-h-[60px] resize-none"})]}),(0,a.jsxs)("button",{onClick:()=>{d(t),o(null)},className:"w-full py-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors flex items-center justify-center gap-2 text-sm",children:[(0,a.jsx)(x.Z,{size:14}),"Eliminar Bloque"]})]})]})}function en(e){var t;let{methodology:s,config:r,onChange:l}=e,n=(null===(t=s.form_config)||void 0===t?void 0:t.fields)||[],c=n.filter(e=>"movements_list"!==e.type),i=n.filter(e=>"movements_list"===e.type);return(0,a.jsxs)("div",{className:"space-y-3",children:[c.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-3 items-end",children:c.map(e=>(0,a.jsx)("div",{children:(0,a.jsx)(ec,{field:e,value:r[e.key],onChange:t=>l(e.key,t),allConfig:r,onConfigChange:l})},e.key))}),i.map(e=>(0,a.jsx)(ec,{field:e,value:r[e.key],onChange:t=>l(e.key,t)},e.key))]})}function ec(e){let{field:t,value:s,onChange:r,allConfig:l,onConfigChange:n}=e;if("movements_list"===t.type)return(0,a.jsx)(ei,{label:t.label,value:s||[],onChange:r,help:t.help});if("select"===t.type&&t.options)return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:t.label}),(0,a.jsx)("select",{value:s||t.default||"",onChange:e=>r(e.target.value),className:"cv-input",children:t.options.map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),t.help&&(0,a.jsx)("p",{className:"text-xs text-cv-text-tertiary mt-1",children:t.help})]});if("tempo"===t.key){let e=(null==l?void 0:l.show_tempo)===!0||!!s&&""!==s;return(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors ".concat(e?"bg-white dark:bg-cv-bg-secondary border-slate-200 dark:border-slate-700":"border-dashed border-slate-300 dark:border-slate-600"),children:[(0,a.jsx)("button",{onClick:()=>{if(n){let t=!e;n("show_tempo",t),t||r("")}},type:"button",className:"w-8 h-4 rounded-full transition-colors relative focus:outline-none ".concat(e?"bg-cv-accent":"bg-slate-300 dark:bg-slate-600"),children:(0,a.jsx)("span",{className:"block w-3 h-3 bg-white rounded-full transition-transform absolute top-0.5 left-0.5 ".concat(e?"translate-x-4":"translate-x-0")})}),(0,a.jsx)("span",{className:"text-sm font-semibold whitespace-nowrap ".concat(e?"text-cv-text-primary":"text-cv-text-tertiary"),children:t.label}),e&&(0,a.jsx)("input",{type:"text",value:s||"",onChange:e=>r(e.target.value),placeholder:"30X1",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-16 text-center animate-in fade-in duration-150"})]})}return"number"===t.type?(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary whitespace-nowrap",children:t.label}),(0,a.jsx)("input",{type:"number",min:1,value:s||"",onChange:e=>r(parseInt(e.target.value)||null),placeholder:t.placeholder||"0",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-bold placeholder:text-slate-300 w-14 text-center"})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary whitespace-nowrap",children:t.label}),(0,a.jsx)("input",{type:"text",value:s||"",onChange:e=>r(e.target.value),placeholder:t.placeholder,className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-16 text-center"})]})}function ei(e){let{label:t,value:s,onChange:r,help:l}=e,n=s||[],c=(e,t)=>{let s=[...n];s[e]=t,r(s)},i=e=>{r(n.filter((t,s)=>s!==e))};return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:t}),l&&(0,a.jsx)("p",{className:"text-xs text-cv-text-tertiary mb-2",children:l}),(0,a.jsxs)("div",{className:"space-y-2",children:[n.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(q,{value:e,onChange:e=>c(t,e),placeholder:"Movimiento ".concat(t+1," (ej: 10 Burpees)"),className:"cv-input"})}),(0,a.jsx)("button",{onClick:()=>i(t),className:"cv-btn-ghost text-red-400 p-2",children:(0,a.jsx)(x.Z,{size:16})})]},t)),(0,a.jsxs)("button",{onClick:()=>{r([...n,""])},className:"w-full py-2 border border-dashed border-cv-border rounded-lg text-cv-text-tertiary hover:text-cv-text-primary hover:border-cv-text-tertiary transition-all flex items-center justify-center gap-2",children:[(0,a.jsx)(h.Z,{size:14}),"A\xf1adir Movimiento"]})]})]})}function eo(e){let{config:t,onChange:s}=e,r=!0===t.show_tempo||!!t.tempo&&""!==t.tempo;return(0,a.jsx)("div",{className:"animate-in fade-in duration-300",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary",children:"Series"}),(0,a.jsx)("input",{type:"number",min:1,value:t.sets||"",onChange:e=>s("sets",parseInt(e.target.value)||null),placeholder:"3",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-bold placeholder:text-slate-300 w-12 text-center"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary",children:"Reps"}),(0,a.jsx)("input",{type:"text",value:t.reps||"",onChange:e=>s("reps",e.target.value),placeholder:"10",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-bold placeholder:text-slate-300 w-14 text-center"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary",children:"% 1RM"}),(0,a.jsx)("input",{type:"text",value:t.percentage||"",onChange:e=>s("percentage",e.target.value),placeholder:"75%",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-16 text-center"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary",children:"RPE"}),(0,a.jsx)("input",{type:"text",value:t.rpe||"",onChange:e=>s("rpe",e.target.value),placeholder:"8",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-10 text-center"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-white dark:bg-cv-bg-secondary px-3 py-2 rounded-lg border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-text-primary",children:"Descanso"}),(0,a.jsx)("input",{type:"text",value:t.rest||"",onChange:e=>s("rest",e.target.value),placeholder:"2:00",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-14 text-center"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border transition-colors ".concat(r?"bg-white dark:bg-cv-bg-secondary border-slate-200 dark:border-slate-700":"border-dashed border-slate-300 dark:border-slate-600"),children:[(0,a.jsx)("button",{onClick:()=>{let e=!r;s("show_tempo",e),e||s("tempo","")},type:"button",className:"w-8 h-4 rounded-full transition-colors relative focus:outline-none ".concat(r?"bg-cv-accent":"bg-slate-300 dark:bg-slate-600"),children:(0,a.jsx)("span",{className:"block w-3 h-3 bg-white rounded-full transition-transform absolute top-0.5 left-0.5 ".concat(r?"translate-x-4":"translate-x-0")})}),(0,a.jsx)("span",{className:"text-sm font-semibold ".concat(r?"text-cv-text-primary":"text-cv-text-tertiary"),children:"Tempo"}),r&&(0,a.jsx)("input",{type:"text",value:t.tempo||"",onChange:e=>s("tempo",e.target.value),placeholder:"30X1",className:"bg-transparent border-none p-0 text-base focus:ring-0 text-cv-text-primary font-medium placeholder:text-slate-300 w-16 text-center animate-in fade-in duration-150"})]})]})})}function ed(e){let{config:t,onChange:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Contenido"}),(0,a.jsx)("textarea",{value:t.content||"",onChange:e=>s("content",e.target.value),placeholder:"Enter any freeform workout or notes...",className:"cv-input min-h-[200px] resize-none text-sm"})]})}function ex(e){let{config:t,onChange:s}=e,r=t.movements||[],l=(e,t)=>{let a=[...r];a[e]=t,s("movements",a)},n=e=>{s("movements",r.filter((t,s)=>s!==e))};return(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-cv-text-secondary mb-2",children:"Movimientos / Ejercicios"}),(0,a.jsxs)("div",{className:"space-y-2",children:[r.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(q,{value:e,onChange:e=>l(t,e),placeholder:"e.g. 3x10 Banded Good Mornings",className:"cv-input"})}),(0,a.jsx)("button",{onClick:()=>n(t),className:"cv-btn-ghost p-2 text-red-400 self-start mt-0.5",children:(0,a.jsx)(x.Z,{size:16})})]},t)),(0,a.jsxs)("button",{onClick:()=>{s("movements",[...r,""])},className:"w-full py-2 border border-dashed border-cv-border rounded-lg text-cv-text-tertiary hover:text-cv-text-primary hover:border-cv-text-tertiary transition-all flex items-center justify-center gap-2",children:[(0,a.jsx)(h.Z,{size:14}),"Add Movement"]})]})]})})}var em=s(92851),ep=s(76637);let eb=[{type:"warmup",label:"Calentamiento",description:"Preparaci\xf3n y movilidad",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-50 dark:bg-emerald-900/30 hover:bg-emerald-100 dark:hover:bg-emerald-900/50",icon:J.Z},{type:"strength_linear",label:"Classic",description:"Series, reps y porcentajes",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50",icon:C.Z},{type:"metcon_structured",label:"MetCon",description:"AMRAP, EMOM, For Time",color:"text-cv-accent",bgColor:"bg-teal-50 dark:bg-teal-900/30 hover:bg-teal-100 dark:hover:bg-teal-900/50",icon:W.Z},{type:"accessory",label:"Accesorio",description:"Trabajo complementario",color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/30 hover:bg-purple-100 dark:hover:bg-purple-900/50",icon:et.Z},{type:"skill",label:"Habilidad",description:"Pr\xe1ctica t\xe9cnica",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50",icon:em.Z},{type:"free_text",label:"Texto Libre",description:"Notas y comentarios",color:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-100 dark:bg-slate-800/50 hover:bg-slate-200 dark:hover:bg-slate-800",icon:ep.Z}];function eu(e){let{dayId:t,dayName:s,onClose:n}=e,{addBlock:o,selectedBlockId:m,selectBlock:p,mesocycles:b,deleteBlock:u,toggleBlockProgression:h}=(0,l.E)(),[g,v]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[y,N]=(0,r.useState)(null),k=null;for(let e of b){let s=e.days.find(e=>e.id===t);if(s){k=s;break}}let w=null;if(m)for(let e of b){for(let t of e.days){let e=t.blocks.find(e=>e.id===m);if(e){w=e;break}}if(w)break}let z=!!(null==w?void 0:w.progression_id);(0,r.useEffect)(()=>{v(z)},[z,m]);let Z=e=>{v(e),m&&h(m,e)},_=e=>{let t=e.config;switch(e.type){case"strength_linear":return!t.sets&&!t.reps&&!t.exercise;case"metcon_structured":let s=t.movements||[];return!e.format&&0===s.length&&!t.time_cap;case"free_text":let a=t.content;return!a||"string"==typeof a&&""===a.trim();case"warmup":case"accessory":case"skill":let r=t.exercises||[],l=t.notes;return 0===r.length&&(!l||"string"==typeof l&&""===l.trim());default:let n=Object.keys(t).filter(e=>"is_completed"!==e);return 0===n.length||n.every(e=>{let s=t[e];return null==s||""===s||Array.isArray(s)&&0===s.length})}},E=(e,t)=>{e.stopPropagation(),_(t)?u(t.id):(N(t.id),j(!0))},S=e=>{eb.find(t=>t.type===e),o(t,e,"free_text"!==e?"STANDARD":void 0,void 0,g)};return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-cv-bg-secondary",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200 dark:border-slate-700 bg-gradient-to-r from-slate-50 to-white dark:from-cv-bg-tertiary dark:to-cv-bg-secondary",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cv-accent to-cv-accent/70 flex items-center justify-center shadow-lg shadow-cv-accent/20",children:(0,a.jsx)(W.Z,{size:20,className:"text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-bold text-cv-text-primary text-lg",children:"Block Builder"}),(0,a.jsxs)("p",{className:"text-xs text-cv-text-tertiary",children:["A\xf1adiendo bloques a ",(0,a.jsx)("span",{className:"font-semibold text-cv-accent",children:s})]})]})]}),(0,a.jsxs)("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-cv-accent text-white rounded-xl font-medium text-sm hover:bg-cv-accent/90 transition-colors shadow-sm",children:[(0,a.jsx)(c.Z,{size:16}),"Guardar y Salir"]})]}),(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)("div",{className:"w-[240px] flex-shrink-0 border-r border-slate-200 dark:border-slate-700 overflow-y-auto bg-slate-50/50 dark:bg-cv-bg-tertiary/50",children:(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("div",{className:"mb-4 bg-white dark:bg-slate-800 p-3 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:(0,a.jsxs)("label",{className:"flex items-center justify-between cursor-pointer group",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"text-sm font-semibold text-cv-text-primary flex items-center gap-1.5",children:[(0,a.jsx)(i.Z,{size:14,className:g?"text-cv-accent":"text-slate-400"}),"Progresi\xf3n"]}),(0,a.jsx)("span",{className:"text-[10px] text-cv-text-tertiary leading-tight mt-0.5",children:"Copiar en todas las semanas"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"checkbox",className:"sr-only",checked:g,onChange:e=>Z(e.target.checked)}),(0,a.jsx)("div",{className:"w-9 h-5 rounded-full transition-colors ".concat(g?"bg-cv-accent":"bg-slate-300 dark:bg-slate-600")}),(0,a.jsx)("div",{className:"absolute top-1 left-1 bg-white w-3 h-3 rounded-full transition-transform ".concat(g?"translate-x-4":"translate-x-0")})]})]})}),(0,a.jsx)("p",{className:"text-[10px] font-bold uppercase tracking-wider text-cv-text-tertiary mb-2 px-1",children:"Tipos de Bloque"}),(0,a.jsx)("div",{className:"space-y-1.5",children:eb.map(e=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:()=>S(e.type),className:"w-full flex items-center gap-3 p-3 rounded-xl transition-all ".concat(e.bgColor," group"),children:[(0,a.jsx)("div",{className:"w-9 h-9 rounded-lg bg-white dark:bg-slate-800 flex items-center justify-center shadow-sm ".concat(e.color),children:(0,a.jsx)(t,{size:18})}),(0,a.jsxs)("div",{className:"text-left flex-1",children:[(0,a.jsx)("p",{className:"font-semibold text-sm text-cv-text-primary",children:e.label}),(0,a.jsx)("p",{className:"text-[10px] text-cv-text-tertiary",children:e.description})]})]},e.type)})})]})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden bg-slate-50/30 dark:bg-cv-bg-tertiary/10",children:[k&&k.blocks.length>0&&(0,a.jsx)("div",{className:"flex-shrink-0 p-3 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-secondary z-10",children:(0,a.jsx)("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 no-scrollbar",children:[...k.blocks].sort((e,t)=>e.order_index-t.order_index).map((e,t)=>{var s;let r=m===e.id,l=eb.find(t=>t.type===e.type),n=(null==l?void 0:l.icon)||C.Z;return(0,a.jsxs)("div",{onClick:()=>p(e.id),className:"\n                                                    group relative flex items-center gap-2 px-3 py-2 rounded-lg border transition-all text-left min-w-[150px] cursor-pointer\n                                                    ".concat(r?"bg-white dark:bg-cv-bg-primary border-cv-accent shadow-sm ring-1 ring-cv-accent/10":"bg-slate-50 dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600","\n                                                "),children:[(0,a.jsx)("button",{onClick:t=>E(t,e),className:"absolute top-1 right-1 w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all shadow-md hover:bg-red-600 hover:scale-110 z-50",title:"Eliminar bloque",children:(0,a.jsx)(d.Z,{size:10,className:"stroke-[3]"})}),(0,a.jsx)("div",{className:"w-7 h-7 rounded-md flex items-center justify-center flex-shrink-0 ".concat(r?"bg-cv-accent text-white":"bg-slate-200 dark:bg-slate-700 text-cv-text-tertiary"),children:(0,a.jsx)(n,{size:14})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs font-semibold truncate ".concat(r?"text-cv-text-primary":"text-cv-text-secondary"),children:e.name||(null==l?void 0:l.label)||"Sin nombre"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("p",{className:"text-[10px] text-cv-text-tertiary truncate",children:e.format}),!!(null===(s=e.config)||void 0===s?void 0:s.is_completed)&&(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(c.Z,{size:6,className:"text-white stroke-[3]"})})]})]})]},e.id)})})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden relative",children:m?(0,a.jsx)("div",{className:"h-full",children:(0,a.jsx)(el,{blockId:m,autoFocusFirst:!0})}):(0,a.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center p-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl bg-slate-100 dark:bg-slate-800 flex items-center justify-center mb-4",children:(0,a.jsx)(W.Z,{size:24,className:"text-slate-300 dark:text-slate-600"})}),(0,a.jsx)("h3",{className:"text-sm font-semibold text-cv-text-primary mb-1",children:"Selecciona un bloque"}),(0,a.jsx)("p",{className:"text-xs text-cv-text-tertiary",children:"A\xf1ade bloques desde la izquierda o selecciona uno arriba."})]})})]})]}),f&&y&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,a.jsx)("div",{className:"bg-white dark:bg-cv-bg-secondary rounded-xl shadow-xl max-w-sm w-full overflow-hidden border border-slate-200 dark:border-slate-700 animate-in fade-in zoom-in-95 duration-200",children:(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-cv-text-primary mb-2 flex items-center gap-2",children:[(0,a.jsx)(x.Z,{size:20,className:"text-red-500"}),"\xbfEliminar bloque?"]}),(0,a.jsx)("p",{className:"text-sm text-cv-text-secondary mb-4",children:"Este bloque tiene contenido. \xbfEst\xe1s seguro de que deseas eliminarlo?"}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)("button",{onClick:()=>{j(!1),N(null)},className:"px-4 py-2 text-sm text-cv-text-secondary hover:text-cv-text-primary font-medium rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{onClick:()=>{u(y),j(!1),N(null)},className:"px-4 py-2 text-sm bg-red-500 hover:bg-red-600 text-white font-medium rounded-lg transition-colors",children:"Eliminar"})]})]})})})]})}var eh=s(2882),eg=s(49031),ev=s(62167),ef=s(65251);let ej={focus:"",considerations:"",technicalClarifications:"",scalingAlternatives:""};function ey(e){let{isOpen:t,onClose:s,weekNumber:l,initialData:n,onSave:c,isSaving:i=!1}=e,[o,x]=(0,r.useState)(ej);(0,r.useEffect)(()=>{n?x(n):x(ej)},[n,t]);let m=(e,t)=>{x(s=>({...s,[e]:t}))};return(0,a.jsx)(ev.M,{children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60]",onClick:s}),(0,a.jsxs)(ef.E.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl max-h-[90vh] flex flex-col bg-white border border-slate-200 rounded-xl shadow-2xl z-[70] overflow-hidden font-sans",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 bg-white sticky top-0 z-10",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-900 tracking-tight",children:"Estrategia del Mesociclo"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 font-medium",children:["Semana ",l," â€” Definici\xf3n de Contexto"]})]}),(0,a.jsx)("button",{onClick:s,className:"p-2 -mr-2 text-slate-400 hover:text-slate-600 hover:bg-slate-50 rounded-full transition-colors",children:(0,a.jsx)(d.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider",children:[(0,a.jsx)(f.Z,{size:14,className:"text-indigo-500"}),"Enfoque Principal"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",value:o.focus,onChange:e=>m("focus",e.target.value),placeholder:"Ej: Fuerza M\xe1xima & Resistencia Muscular Local",className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all font-medium"}),(0,a.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:'Define el objetivo "North Star" para este bloque de entrenamiento.'})]})]}),(0,a.jsx)("hr",{className:"border-slate-100"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-8",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider",children:[(0,a.jsx)(eh.Z,{size:14,className:"text-emerald-500"}),"Consideraciones del Coach"]}),(0,a.jsx)("textarea",{value:o.considerations,onChange:e=>m("considerations",e.target.value),placeholder:"Notas sobre estilo de vida, sue\xf1o, nutrici\xf3n o foco mental para esta semana...",rows:3,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all resize-none leading-relaxed"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider",children:[(0,a.jsx)(eg.Z,{size:14,className:"text-blue-500"}),"Aclaraciones T\xe9cnicas"]}),(0,a.jsx)("textarea",{value:o.technicalClarifications,onChange:e=>m("technicalClarifications",e.target.value),placeholder:"Explicaci\xf3n de tempos, RPEs, o ejecuciones espec\xedficas...",rows:3,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all resize-none leading-relaxed"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 text-xs font-bold text-slate-500 uppercase tracking-wider",children:[(0,a.jsx)($.Z,{size:14,className:"text-orange-500"}),"Escalado & Alternativas"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("textarea",{value:o.scalingAlternatives,onChange:e=>m("scalingAlternatives",e.target.value),placeholder:"Opciones para atletas lesionados o sin equipo espec\xedfico...",rows:3,className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg text-slate-900 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all resize-none leading-relaxed"}),(0,a.jsx)("div",{className:"absolute top-3 right-3",children:(0,a.jsxs)("span",{className:"flex h-2 w-2",children:[(0,a.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-orange-400 opacity-75"}),(0,a.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-orange-500"})]})})]})]})]})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-slate-100 bg-slate-50 flex justify-end gap-3 rounded-b-xl sticky bottom-0",children:[(0,a.jsx)("button",{onClick:s,className:"px-5 py-2.5 text-sm font-medium text-slate-600 hover:text-slate-800 hover:bg-white border border-transparent hover:border-slate-200 rounded-lg transition-all",children:"Cancelar"}),(0,a.jsx)("button",{onClick:()=>{c(o)},disabled:i,className:"px-6 py-2.5 text-sm font-semibold text-white bg-slate-900 hover:bg-slate-800 rounded-lg shadow-lg shadow-slate-900/20 hover:shadow-slate-900/30 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{size:16,className:"animate-spin"}),"Guardando..."]}):"Guardar Estrategia"})]})]})]})})}var eN=s(83423),ek=s(40734),ew=s(20173),eC=s(62188),ez=s(73067),eZ=s(92295),e_=s(61721),eE=s(64094),eS=s(99670),eA=s(35817),eM=s(61396),eP=s.n(eM),eD=s(42692),eT=s.n(eD),eR=s(60930),eF=s(38438);function eI(e){let{isOpen:t,onClose:s,programName:l,clientInfo:n,coachName:c,monthlyStrategy:o,weeks:x,strategy:m}=e,p=(0,r.useRef)(null),[b,u]=(0,r.useState)(!1),[h,g]=(0,r.useState)("png"),v=async()=>{if(p.current){u(!0);try{let e=await eT()(p.current,{backgroundColor:"#1f2937",scale:2,useCORS:!0});if("png"===h){let t=document.createElement("a");t.download="".concat(n.name,"-").concat(l,".png"),t.href=e.toDataURL("image/png"),t.click()}else{let t=e.toDataURL("image/png"),s=new eR.kH({orientation:"portrait",unit:"px",format:[e.width/2,e.height/2]});s.addImage(t,"PNG",0,0,e.width/2,e.height/2),s.save("".concat(n.name,"-").concat(l,".pdf"))}}catch(e){console.error("Export failed:",e)}finally{u(!1)}}};return(0,a.jsx)(ev.M,{children:t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ef.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50",onClick:s}),(0,a.jsxs)(ef.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-4 md:inset-8 lg:inset-12 bg-cv-bg-secondary border border-cv-border rounded-xl shadow-cv-lg z-50 flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-cv-border bg-cv-bg-secondary shrink-0",children:[(0,a.jsx)("h2",{className:"font-semibold text-cv-text-primary",children:"Vista Previa Exportaci\xf3n"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex bg-cv-bg-tertiary rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>g("png"),className:"px-3 py-1 rounded-md text-sm font-medium transition-all flex items-center gap-1.5\n                      ".concat("png"===h?"bg-cv-accent text-white":"text-cv-text-secondary hover:text-cv-text-primary"),children:[(0,a.jsx)(eF.Z,{size:14}),"PNG"]}),(0,a.jsxs)("button",{onClick:()=>g("pdf"),className:"px-3 py-1 rounded-md text-sm font-medium transition-all flex items-center gap-1.5\n                      ".concat("pdf"===h?"bg-cv-accent text-white":"text-cv-text-secondary hover:text-cv-text-primary"),children:[(0,a.jsx)(ep.Z,{size:14}),"PDF"]})]}),(0,a.jsxs)("button",{onClick:v,disabled:b,className:"cv-btn-primary",children:[b?(0,a.jsx)(D.Z,{size:16,className:"animate-spin"}):(0,a.jsx)(eA.Z,{size:16}),b?"Exportando...":"Exportar"]}),(0,a.jsx)("button",{onClick:s,className:"cv-btn-ghost p-2",children:(0,a.jsx)(d.Z,{size:18})})]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4 md:p-6",children:(0,a.jsxs)("div",{ref:p,className:"bg-[#1f2937] rounded-xl overflow-hidden max-w-3xl mx-auto shadow-2xl",style:{minWidth:"500px"},children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[n.logo?(0,a.jsx)("img",{src:n.logo,alt:n.name,className:"w-14 h-14 rounded-xl object-cover"}):(0,a.jsx)("div",{className:"w-14 h-14 rounded-xl bg-gradient-to-br from-cv-accent to-orange-600 flex items-center justify-center text-white font-bold text-xl",children:n.name.charAt(0)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white",children:n.name}),(0,a.jsx)("p",{className:"text-gray-400",children:l})]}),(null==o?void 0:o.duration)&&(0,a.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-gray-800/50 rounded-lg border border-gray-700/50",children:[(0,a.jsx)(E.Z,{size:16,className:"text-cv-accent"}),(0,a.jsx)("span",{className:"text-sm text-gray-300",children:o.duration})]})]})}),o&&(0,a.jsxs)("div",{className:"p-6 border-b border-gray-800 bg-gradient-to-b from-gray-900/50 to-transparent",children:[o.focus&&(0,a.jsxs)("div",{className:"mb-6 flex gap-3",children:[(0,a.jsx)(f.Z,{size:18,className:"text-cv-accent shrink-0 mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-cv-accent uppercase tracking-wide mb-1",children:"Foco del Mesociclo"}),(0,a.jsx)("p",{className:"text-gray-200 text-lg leading-relaxed",children:o.focus})]})]}),o.progressions&&o.progressions.length>0&&(0,a.jsxs)("div",{className:"mb-6 flex gap-3",children:[(0,a.jsx)(i.Z,{size:18,className:"text-green-500 shrink-0 mt-1"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-green-500 uppercase tracking-wide mb-3",children:"Progresiones"}),(0,a.jsxs)("div",{className:"bg-gray-800/40 rounded-xl p-4 space-y-4 border border-gray-800",children:[(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 text-center",children:[(0,a.jsx)("div",{className:"text-left text-gray-500 text-xs uppercase tracking-wide",children:"Ejercicio"}),(0,a.jsx)("div",{className:"text-gray-500 text-xs uppercase tracking-wide",children:"Sem 1"}),(0,a.jsx)("div",{className:"text-gray-500 text-xs uppercase tracking-wide",children:"Sem 2"}),(0,a.jsx)("div",{className:"text-gray-500 text-xs uppercase tracking-wide",children:"Sem 3"}),(0,a.jsx)("div",{className:"text-gray-500 text-xs uppercase tracking-wide",children:"Sem 4"})]}),o.progressions.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 items-center py-2 border-t border-gray-800/50",children:[(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("span",{className:"text-white font-medium",children:e.name}),e.notes&&(0,a.jsx)("p",{className:"text-gray-500 text-xs mt-0.5",children:e.notes})]}),e.progression.map((t,s)=>(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("span",{className:"font-mono text-sm ".concat(s===e.progression.length-1?"text-green-400 font-bold":"text-gray-300"),children:t})},s)),Array.from({length:4-e.progression.length}).map((e,t)=>(0,a.jsx)("div",{className:"text-center text-gray-600",children:"-"},"empty-".concat(t)))]},t))]})]})]}),o.objectives&&o.objectives.length>0&&(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"w-[18px] shrink-0"})," ",(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Objetivos del Ciclo"}),(0,a.jsx)("ul",{className:"space-y-1",children:o.objectives.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2 text-sm text-gray-300",children:[(0,a.jsx)("span",{className:"text-cv-accent mt-1",children:"â€¢"}),e]},t))})]})]})]}),!o&&m&&(m.focus||m.considerations)&&(0,a.jsxs)("div",{className:"p-6 border-b border-gray-800",children:[m.focus&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 rounded-full bg-cv-accent"}),(0,a.jsx)("span",{className:"text-sm font-semibold text-cv-accent uppercase tracking-wide",children:"Enfoque"})]}),(0,a.jsx)("p",{className:"text-gray-300 text-sm mb-3",children:m.focus})]}),m.considerations&&(0,a.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3 mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1",children:"Consideraciones del Coach"}),(0,a.jsx)("p",{className:"text-gray-300 text-sm whitespace-pre-line",children:m.considerations})]})]}),!o&&m&&(m.technicalClarifications||m.scalingAlternatives)&&(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-800 bg-gray-800/30",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[m.technicalClarifications&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-blue-400 uppercase tracking-wide mb-1",children:"\uD83D\uDD27 Aclaraciones T\xe9cnicas"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs whitespace-pre-line",children:m.technicalClarifications})]}),m.scalingAlternatives&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-orange-400 uppercase tracking-wide mb-1",children:"âš ï¸ Escalado & Alternativas"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs whitespace-pre-line",children:m.scalingAlternatives})]})]})}),x&&x.length>0&&(0,a.jsxs)("div",{className:"p-6 space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(C.Z,{size:18,className:"text-orange-500"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-orange-500 uppercase tracking-wide",children:"Detalle Semanal"})]}),x.map((e,t)=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-700 pb-2",children:[(0,a.jsxs)("h3",{className:"text-white text-lg font-bold",children:["Semana ",e.weekNumber]}),e.focus&&(0,a.jsx)("span",{className:"text-xs text-gray-300 bg-black/20 px-2 py-1 rounded border border-gray-700/50",children:e.focus})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.days&&e.days.map((e,t)=>(0,a.jsxs)("div",{className:"bg-gray-900/20 rounded-xl border border-gray-700/50 overflow-hidden flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"px-4 py-2 bg-black/20 border-b border-gray-700/50 flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-gray-200 font-semibold text-sm uppercase tracking-wide",children:e.name}),(0,a.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-gray-600"})]}),(0,a.jsx)("div",{className:"p-4 space-y-4 flex-1",children:e.blocks.length>0?e.blocks.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"w-1 rounded-full shrink-0 self-stretch ".concat("strength_linear"===e.type?"bg-red-500/80":"metcon_structured"===e.type?"bg-orange-500/80":"warmup"===e.type?"bg-green-500/80":"skill"===e.type?"bg-blue-500/80":"bg-gray-500/80")}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 pb-1",children:[(0,a.jsx)("div",{className:"mb-1",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-100 block truncate",children:e.name})}),(0,a.jsx)("div",{className:"space-y-0.5",children:e.content.map((e,t)=>(0,a.jsx)("p",{className:"font-mono text-xs leading-relaxed ".concat(0===t?"text-gray-200 font-semibold":"text-gray-500"),children:e},t))})]})]},t)):(0,a.jsx)("p",{className:"text-gray-600 text-xs italic py-2 text-center",children:"Descanso"})})]},t))})]},t))]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-gray-800 flex items-center justify-between bg-gray-900/50",children:[(0,a.jsxs)("p",{className:"text-gray-500 text-xs uppercase tracking-wider",children:["Programado por ",c]}),(0,a.jsxs)("p",{className:"text-gray-600 text-xs font-mono flex items-center gap-1.5",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 bg-cv-accent rounded-full"}),"AI COACH"]})]})]})})]})]})})}function eq(e){let{status:t}=e,s={idle:{icon:eN.Z,text:"",className:"text-cv-text-tertiary"},typing:{icon:ek.Z,text:"Editando...",className:"text-amber-500"},saving:{icon:D.Z,text:"Guardando...",className:"text-cv-accent animate-pulse"},saved:{icon:ew.Z,text:"Guardado",className:"text-emerald-500"},error:{icon:eC.Z,text:"Error",className:"text-red-500"}}[t],r=s.icon;return"idle"===t?null:(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-slate-100 dark:bg-slate-800 ".concat(s.className," transition-all"),children:[(0,a.jsx)(r,{size:14,className:"saving"===t?"animate-spin":""}),(0,a.jsx)("span",{className:"text-xs font-medium",children:s.text})]})}function eO(e){let{programId:t,programName:s,isFullScreen:n=!1,onToggleFullScreen:c}=e,{mesocycles:i,selectedWeek:o,selectedBlockId:d,selectWeek:x,selectBlock:m,updateMesocycle:p,programAttributes:b,hasUnsavedChanges:u,programCoachName:h,blockBuilderMode:g,blockBuilderDayId:v,exitBlockBuilder:j,enterBlockBuilder:y}=(0,l.E)(),{status:N,forceSave:k}=function(e){let{programId:t,debounceMs:s=500}=e,[a,n]=(0,r.useState)("idle"),[c,i]=(0,r.useState)(null),o=(0,r.useRef)(null),d=(0,r.useRef)(""),{mesocycles:x,hasUnsavedChanges:m,markAsClean:p}=(0,l.E)(),b=JSON.stringify(x),u=(0,r.useCallback)(async()=>{if(t&&0!==x.length){n("saving");try{let e=await (0,P.Ml)(t,x);e.success?(p(),i(new Date),n("saved"),setTimeout(()=>n("idle"),2e3)):(n("error"),console.error("Auto-save failed:",e.error))}catch(e){n("error"),console.error("Auto-save error:",e)}}},[t,x,p]);return(0,r.useEffect)(()=>{if(b!==d.current){if(""===d.current){d.current=b;return}if(d.current=b,m)return n("typing"),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{u()},s),()=>{o.current&&clearTimeout(o.current)}}},[b,m,u,s]),(0,r.useEffect)(()=>{if(!m)return;let e=setInterval(()=>{"saving"!==a&&u()},3e4);return()=>clearInterval(e)},[m,a,u]),{status:a,lastSaved:c,forceSave:(0,r.useCallback)(async()=>{o.current&&clearTimeout(o.current),await u()},[u])}}({programId:t,debounceMs:500}),[w,C]=(0,r.useState)(!1),[z,Z]=(0,r.useState)(!1),E=i.find(e=>e.week_number===o),S=(null==b?void 0:b.global_focus)||null;(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&g&&j()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[g,j]);let A=(0,r.useMemo)(()=>{if(!v||!E)return"";let e=E.days.find(e=>e.id===v);return e?["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"][(e.day_number-1)%7]:""},[v,E]),T=(0,r.useMemo)(()=>{if(!(null==E?void 0:E.attributes))return;let e=E.attributes;return{focus:e.focus||E.focus||"",considerations:e.considerations||"",technicalClarifications:e.technicalClarifications||"",scalingAlternatives:e.scalingAlternatives||""}},[E]),R=(0,r.useMemo)(()=>{let e=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado","Domingo"];return i.sort((e,t)=>e.week_number-t.week_number).map(t=>({weekNumber:t.week_number,focus:t.focus||"",days:t.days.filter(e=>!e.is_rest_day&&e.blocks.length>0).sort((e,t)=>e.day_number-t.day_number).map(t=>({name:e[(t.day_number-1)%7]||"D\xeda ".concat(t.day_number),blocks:t.blocks.map(e=>({type:e.type,name:e.name||e.type,content:function(e,t){if("strength_linear"===e)return[["".concat(t.sets,"x").concat(t.reps),t.percentage?"@ ".concat(t.percentage):"",t.rpe?"@ RPE ".concat(t.rpe):""].filter(Boolean).join(" "),t.notes].filter(Boolean);if("metcon_structured"===e){let e=[],s=[t.time_cap||t.minutes?"Time Cap: ".concat(t.time_cap||t.minutes," min"):"",t.rounds?"".concat(t.rounds," Rounds"):"",t.score_type?"Score: ".concat(t.score_type):""].filter(Boolean).join(" | ");return s&&e.push(s),Array.isArray(t.movements)?e.push(...t.movements):"string"==typeof t.content&&e.push(...t.content.split("\n")),t.notes&&e.push(t.notes),e}if(t.movements&&Array.isArray(t.movements)){let e=[...t.movements];return t.notes&&e.push(t.notes),e}return t.content?t.content.split("\n"):[t.notes||""]}(e.type,e.config)}))}))}))},[i]),F=(0,r.useMemo)(()=>{let e=i.find(e=>1===e.week_number),t=(null==e?void 0:e.attributes)||{},a=new Map;i.sort((e,t)=>e.week_number-t.week_number).forEach(e=>{e.days.forEach(t=>{t.blocks.forEach(t=>{if((t.progression_id||"strength_linear"===t.type)&&t.name){let s=t.config,r="";if("strength_linear"===t.type){let e=s.percentage||"",t=s.sets||0,a=s.reps||0;r=e||"".concat(t,"x").concat(a)}else r="metcon_structured"===t.type&&(s.time_cap||s.rounds)||"Active";a.has(t.name)||a.set(t.name,[]);let l=a.get(t.name);for(;l.length<e.week_number-1;)l.push("-");l.push(r)}})})});let r=Array.from(a.entries()).map(e=>{let[t,s]=e;return{name:t,progression:s}}),l=[];return i.forEach(e=>{let t=e.attributes||{};if(t.considerations&&"string"==typeof t.considerations){let e=t.considerations.split("\n").filter(e=>e.trim());l.push(...e.slice(0,1))}}),{focus:t.focus||(null==e?void 0:e.focus)||s,duration:"".concat(i.length," semanas"),objectives:Array.from(new Set(l)).slice(0,4),progressions:r}},[i,s]),I=(0,r.useCallback)(e=>{p(o,{focus:e.focus,attributes:{...(null==E?void 0:E.attributes)||{},focus:e.focus,considerations:e.considerations,technicalClarifications:e.technicalClarifications,scalingAlternatives:e.scalingAlternatives}}),Z(!1)},[o,p,E]),q=!!((null==T?void 0:T.focus)||(null==T?void 0:T.considerations)||(null==T?void 0:T.technicalClarifications)||(null==T?void 0:T.scalingAlternatives));return(0,a.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-cv-border bg-white/80 dark:bg-cv-bg-secondary/80 backdrop-blur-sm flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[g?(0,a.jsx)("button",{onClick:j,className:"cv-btn-ghost p-1.5 rounded-lg flex items-center gap-1 text-cv-text-secondary hover:text-cv-text-primary hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",title:"Volver a Vista Semanal",children:(0,a.jsx)(ez.Z,{size:16})}):(0,a.jsx)(eP(),{href:"/programs",className:"cv-btn-ghost p-1.5 rounded-lg flex items-center gap-1 text-cv-text-secondary hover:text-cv-text-primary hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",title:"Volver a Programas",children:(0,a.jsx)(ez.Z,{size:16})}),(0,a.jsx)("div",{className:"w-px h-5 bg-cv-border"}),(0,a.jsx)("div",{children:(0,a.jsxs)("h2",{className:"text-sm font-semibold text-cv-text-primary flex items-center gap-1.5",children:[s,(null==E?void 0:E.focus)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"text-cv-text-tertiary",children:"/"}),(0,a.jsx)("span",{className:"text-cv-accent font-medium",children:E.focus})]})]})}),(0,a.jsx)(eq,{status:N})]}),(0,a.jsx)("div",{className:"flex items-center gap-0.5 bg-slate-100 dark:bg-cv-bg-tertiary rounded-lg p-0.5",children:[1,2,3,4].map(e=>(0,a.jsxs)("button",{onClick:()=>x(e),className:"\n                                px-3 py-1 rounded-md text-xs font-medium transition-all\n                                ".concat(o===e?"bg-white dark:bg-cv-accent text-cv-text-primary dark:text-white shadow-sm":"text-cv-text-secondary hover:text-cv-text-primary hover:bg-white/50 dark:hover:bg-cv-bg-elevated","\n                            "),children:["Semana ",e]},e))}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsxs)("button",{onClick:()=>k(),disabled:"saving"===N,className:"\n                            px-3 py-1.5 rounded-lg flex items-center gap-1.5 text-xs font-medium transition-all mr-1\n                            ".concat(u?"bg-cv-accent text-white hover:bg-cv-accent/90 shadow-sm":"bg-transparent text-cv-text-secondary hover:bg-slate-100 dark:hover:bg-slate-800","\n                        "),title:u?"Guardar cambios":"Todo guardado",children:["saving"===N?(0,a.jsx)(D.Z,{size:14,className:"animate-spin"}):u?(0,a.jsx)(eZ.Z,{size:14}):(0,a.jsx)(ew.Z,{size:14,className:"text-emerald-500"}),"saving"===N?"Guardando...":u?"Guardar":"Guardado"]}),(0,a.jsx)("div",{className:"w-px h-4 bg-cv-border mx-1"}),(0,a.jsxs)("button",{onClick:()=>Z(!0),className:"cv-btn-ghost px-2 py-1 rounded-lg flex items-center gap-1 text-xs font-medium transition-colors\n                            ".concat(q?"text-cv-accent bg-cv-accent/5":"text-cv-text-secondary hover:bg-slate-100 dark:hover:bg-slate-800"),title:"Estrategia del Mesociclo",children:[(0,a.jsx)(f.Z,{size:14}),"Estrategia",q&&(0,a.jsx)("span",{className:"w-2 h-2 rounded-full bg-cv-accent"})]}),(0,a.jsx)("div",{className:"w-px h-4 bg-cv-border"}),(0,a.jsx)("button",{className:"cv-btn-ghost p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",title:"Undo",children:(0,a.jsx)(e_.Z,{size:14})}),(0,a.jsx)("button",{className:"cv-btn-ghost p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",title:"Redo",children:(0,a.jsx)(eE.Z,{size:14})}),(0,a.jsx)("div",{className:"w-px h-4 bg-cv-border"}),(0,a.jsx)("button",{className:"cv-btn-ghost p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",title:"Preview",children:(0,a.jsx)(eS.Z,{size:14})}),(0,a.jsxs)("button",{onClick:()=>C(!0),className:"cv-btn-secondary px-2.5 py-1 rounded-lg flex items-center gap-1.5 text-xs font-medium",title:"Exportar PDF",children:[(0,a.jsx)(eA.Z,{size:14}),"Exportar"]})]})]}),g&&v?(0,a.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,a.jsx)("div",{className:"w-[350px] flex-shrink-0 border-r border-slate-200 dark:border-slate-700 bg-white dark:bg-cv-bg-primary z-10 shadow-xl",children:E&&(0,a.jsx)(M,{mesocycle:E,dayId:v,onSelectDay:e=>y(e)})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden animate-in slide-in-from-right-4 duration-300",children:(0,a.jsx)(eu,{dayId:v,dayName:A,onClose:j})})]}):(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4 bg-gradient-to-br from-slate-50 to-white dark:from-cv-bg-primary dark:to-cv-bg-secondary",children:E?(0,a.jsx)(_,{mesocycle:E,programGlobalFocus:S}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("p",{className:"text-cv-text-tertiary mb-4",children:["No hay datos para la Semana ",o]})})})}),(0,a.jsx)(ey,{isOpen:z,onClose:()=>Z(!1),weekNumber:o,initialData:T,onSave:I}),(0,a.jsx)(eI,{isOpen:w,onClose:()=>C(!1),programName:s,clientInfo:{name:"Cliente"},coachName:h||"Coach",monthlyStrategy:F,weeks:R,strategy:T})]})}},45787:function(e,t,s){s.d(t,{u:function(){return n}});var a=s(57437),r=s(2265),l=s(82549);function n(e){let{isOpen:t,onClose:s,title:n,children:c,description:i,maxWidth:o="max-w-md"}=e;return((0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&s()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,s]),t)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:s}),(0,a.jsxs)("div",{className:"relative w-full ".concat(o," bg-gradient-to-br from-[#1a1b1e] to-[#141518] border border-white/10 rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col max-h-[90vh]"),children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-blue-500/10 to-transparent pointer-events-none"}),(0,a.jsxs)("div",{className:"relative flex items-center justify-between p-6 border-b border-white/5 shrink-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white",children:n}),i&&(0,a.jsx)("p",{className:"text-sm text-gray-400",children:i})]}),(0,a.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors p-2 hover:bg-white/5 rounded-lg",children:(0,a.jsx)(l.Z,{size:20})})]}),(0,a.jsx)("div",{className:"relative p-6 overflow-y-auto",children:c})]})]}):null}}}]);
